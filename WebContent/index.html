<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title></title>
<link rel="stylesheet"
	href="static/bootstrap-3.3.5-dist/css/bootstrap.min.css">

</head>
<body class="container">
	<div class="jumbotron">
		<h2>Web打印控件样例</h2>
		服务端打印DEMO采用简单的Servlet 3.0。本地打印DEMO是基于Blade的轻量级MVC框架，访问端口9000。
		<p></p>

		<button type="button" id="printBtn" onclick="print_server('zjd')"
			class="btn btn-primary">点击打印</button>

	</div>

	<script type="text/javascript" src="static/jquery.min.js"></script>
	<script type="text/javascript"
		src="static/bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>

	<script type="text/javascript">
		function print_server(method_name) {
			$.ajax({
				url : "print?method=" + method_name,
				dataType : "json",
				success : function(data) {
					if (data.status == -1) {
						alert(data.msg);
						return;
					}
					local_print(data);
				},
				error : function(data) {
					console.log(data);
					alert("服务器数据传输失败,请查看控制台日志");
				}
			});
		}

		function local_print(data) {
			$.ajax({
				url : "http://127.0.0.1:9000/",
				type : 'POST',
				crossDomain : true,
				dataType : "json",
				data : {
					"data" : JSON.stringify(data)
				},
				error : function(e) {
					alert("本地数据传输失败,可能本地打印程序玩未启动：" + e.statusText);
				},
				success : function(data) {
					if (data.status == -1) {
						alert("本地打印失败：" + data.msg);
					}
				}
			});
		}
	</script>

</body>
</html>